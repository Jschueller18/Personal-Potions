<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Personal Potions API Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        button {
            background: #1a73e8;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 0;
        }
        button:hover {
            background: #1557b0;
        }
        pre {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
            margin-top: 20px;
        }
        .log {
            margin-top: 20px;
        }
        .error {
            color: #d32f2f;
        }
        .success {
            color: #388e3c;
        }
    </style>
</head>
<body>
    <h1>Personal Potions API Test</h1>
    <p>Use the buttons below to test different API endpoints and configurations.</p>
    
    <div>
        <button onclick="testBaseEndpoint()">Test Base Endpoint</button>
        <button onclick="testSurveyEndpoint()">Test Survey Endpoint</button>
        <button onclick="testCorsOptions()">Test CORS Options</button>
        <button onclick="clearLog()">Clear Log</button>
    </div>
    
    <div class="log" id="log"></div>
    
    <script>
        const logElement = document.getElementById('log');
        
        function log(message, type = 'info') {
            const entry = document.createElement('pre');
            entry.className = type;
            entry.textContent = message;
            logElement.appendChild(entry);
            console.log(message);
        }
        
        function clearLog() {
            logElement.innerHTML = '';
        }
        
        async function testBaseEndpoint() {
            log('Testing base endpoint...');
            try {
                const response = await fetch('https://personal-potions-api.vercel.app/');
                log(`Status: ${response.status}`, response.ok ? 'success' : 'error');
                
                try {
                    const data = await response.json();
                    log(`Response (JSON): ${JSON.stringify(data, null, 2)}`, response.ok ? 'success' : 'error');
                } catch (e) {
                    const text = await response.text();
                    log(`Response (Text): ${text}`, response.ok ? 'success' : 'error');
                }
            } catch (error) {
                log(`Error: ${error.message}`, 'error');
            }
        }
        
        async function testSurveyEndpoint() {
            log('Testing survey endpoint...');
            try {
                const payload = {
                    name: 'Test User',
                    email: 'test@example.com',
                    age: 30,
                    gender: 'male',
                    weight: 70,
                    height: 175,
                    activityLevel: 'moderate',
                    goals: ['hydration'],
                    usage: ['daily'],
                    flavorPreferences: ['citrus'],
                    caffeinePreference: 'low',
                    servingSize: 'regular'
                };
                
                log(`Request payload: ${JSON.stringify(payload, null, 2)}`);
                
                const response = await fetch('https://personal-potions-api.vercel.app/api/customers/survey', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(payload)
                });
                
                log(`Status: ${response.status}`, response.ok ? 'success' : 'error');
                
                try {
                    const data = await response.json();
                    log(`Response: ${JSON.stringify(data, null, 2)}`, response.ok ? 'success' : 'error');
                } catch (e) {
                    const text = await response.text();
                    log(`Response (Text): ${text}`, response.ok ? 'success' : 'error');
                }
            } catch (error) {
                log(`Error: ${error.message}`, 'error');
            }
        }
        
        async function testCorsOptions() {
            log('Testing CORS OPTIONS request...');
            try {
                const response = await fetch('https://personal-potions-api.vercel.app/api/customers/survey', {
                    method: 'OPTIONS'
                });
                
                log(`Status: ${response.status}`, response.ok ? 'success' : 'error');
                log('Headers:');
                
                for (const [key, value] of response.headers.entries()) {
                    log(`  ${key}: ${value}`);
                }
            } catch (error) {
                log(`Error: ${error.message}`, 'error');
            }
        }
    </script>
</body>
</html> 